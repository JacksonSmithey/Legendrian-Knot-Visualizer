<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generating Family Visualizer</title>
    <!--Import plotly and MathJax typesetting--> 
<script type="application/json" src="https://github.com/plotly/plotly.js/releases/tag/v3.0.1"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <ul class="navbar">
        <li><img class="logo" src="{{ url_for('static',filename='Icon/GFG_Logo.png') }}"></li>
        <li><a href="/">Home</a></li>
        <li><a href="/Library">Knot Library</a></li>
        <li><a href="/About">About</a></li>
      </ul>
    </nav>

    <h2>Generating Family Visualizer</h2>
    <div class="info_text">
      <p>The GFG takes generating families for Legendrian knots and plots their embeddings in \(R^3\).
        A generating family is a polynomial that generates a positive dimensional system of equations
        whose critical locus generates an embedding of \(S^1\) in \(R^3\).
      </p>
      <p>Enter the generating family as a polynomial function \(f(x,E)\). Where \(E=\{e1,e2,...\}\) is the 
        "curve generating dimension".
        To vary a constant and create multiple graphs of the same generating family, use \(A=\{a1,a2,...\}\)
        values and the provided table entry. 
        ex. with one E-dimension, and one \(a\) control values. Results in an unknot for \(a_1 &gt; 0\) 
          \[f(x,E) = (a_1-x^2)e_1-e_1^3\]
      </p>
      <p>
        <strong>Text Entry Rules:</strong>
        Polynomials must be parsable by Python math libraries. Meaning explicit * for multiplication, 
        ** for exponentiation, and careful parenthesis to preserve order of operations (especially with division).
        When typing your generating family, use e1,e2,... for E variables and a1,a2,... for user determined constants. 
      </p>
      <p><strong>Other Notes:</strong>
        The GFG will attempt to plot anything, even if it's not Legendrian. 
        Exponential functions are supported, but trig functions may not have all solutions returned.
        Multiple sets of graphs (multiple \(a\)-values) will multiply calculation times.
        If a plot has no points or the page never loads, 
        check if the critical locus of \(f\) is empty or the solution set is infinite</p>
    </div>

    <h2>Generating Family Info</h2>
    <form method="POST" action="/Graphs">
      <label for="eDim">Number of \(e\) dimensions (&lt;6):</label>
      <input type="text" id="eDim" name="eDim" class="shortText" value="1"><br>

      <label for="aDim">Number of \(a\) control variables:</label>
      <input type="text" id="aDim" name="aDim" class="shortText" value="0"><br>

      <div class="a_i_button_div">
        <button type="button" class="a_i_button" onclick="addControlRow()">Click to add an \(a_i\) parameter</button>
        <button type="button" class="a_i_button" onclick="removeControlRow()">Click to remove \(a_i\) parameter</button>
      </div>
    
    <table id="a_i_table">
      <thead>
        <tr>
          <td>Name</td>
          <td>Begin</td>
          <td>End</td>
          <td>Increment</td>
        </tr>
      </thead>
      <tbody>
        <!-- Script Adds Rows Here -->
      </tbody>
    </table>

    <script>
        /* Manage Dynamic Table for A values */
      var counter = 0;

      function addControlRow() {
        var table = document.getElementById("a_i_table").getElementsByTagName('tbody')[0];
        var row = table.insertRow();
        counter++;

        // Set a_i
        var a_number = row.insertCell(0);
        var a_begin = row.insertCell(1);
        var a_end = row.insertCell(2);
        var a_increment = row.insertCell(3);

        // Set row label
        a_number.innerHTML = `a${counter}`;

        // Create a new input elements
        var begin_input = document.createElement('input'); 
        var end_input = document.createElement('input'); 
        var increment_input = document.createElement('input'); 

        // Set attributes for new input elements
        begin_input.setAttribute('type', 'text'); begin_input.setAttribute('name', 'a_params[]');
        begin_input.setAttribute('value', '0'); begin_input.setAttribute('id', `begin${counter}`);

        end_input.setAttribute('type', 'text'); end_input.setAttribute('name', 'a_params[]');
        end_input.setAttribute('value', '1'); end_input.setAttribute('id', `end${counter}`);

        increment_input.setAttribute('type', 'text'); increment_input.setAttribute('name', 'a_params[]');
        increment_input.setAttribute('value', '1'); increment_input.setAttribute('id', `increment${counter}`);

        // Append new input elements to the form
        a_begin.appendChild(begin_input);
        a_end.appendChild(end_input);
        a_increment.appendChild(increment_input);
      }

      function removeControlRow() {
        var table = document.getElementById("a_i_table");
        if (counter > 0) {
          var row = table.deleteRow(-1);
          counter--;
        }
      }
    </script>

    <div class="spacer"></div>

    <label for="genFam">Generating family (using +,-,*,/,**):</label><br>
    <textarea id="genFam" name="genFam" rows="3" cols="50" class="auto_height">(a1-x**2)*e1-e1**3</textarea><br>

    <h3>Graphing Options</h3>  
    <div class="projections">
      <label for="granularity">Granularity:</label>
      <input type="text" id="granularity" name="granularity" class="shortText" value="0.1"><br>

      <label for="pThree">3-Dimensional:</label>
      <input type="checkbox" id="pThree" name="pThree" value="True"><br>

      <label for="pTop">Top/Lagrangian Projection:</label>
      <input type="checkbox" id="pTop" name="pTop" value="True"><br>

      <label for="pFront">Front Projection:</label>
      <input type="checkbox" id="pFront" name="pFront" value="True"><br>
    </div><br>

    <input type="submit" class="submitButton" value="Submit">
    </form>
    <p class="submit-text">
      *Processing may take arbitrarily long depending on the function, dimensionality, and the number of graphs generated*
    </p>
    <div class="end_spacer"></div>
  </body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
